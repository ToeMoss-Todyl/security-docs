[[alert-schema]]

== Alert schema

{elastic-sec} stores alerts that have been generated by detection rules in hidden {es} indices.  In 7.x versions, the index pattern was `.siem-signals-<spacename>-*`.  In 8.x versions, the index pattern is `.alerts-security.alerts-<spacename>-*`, and the field names have changed. The following table includes the new names and provides a cross-reference to the previous field names.

NOTE: Users are advised NOT to use the `_source field` in alert documents, but rather use the fields API to programmatically obtain the list of fields used in these documents. Learn more about {ref}/search-fields.html[retrieving selected fields from a search].

[width="100%",options="header"]
|==============================================
|Legacy signal field |Alerts-as-data field | Description

|{ecs-ref}/ecs-base.html#field-timestamp[`@timestamp`] |`@timestamp` | ECS field, represents the time when the alert was created or most recently updated.
|{ecs-ref}/ecs-base.html#field-message[`message`]| `message` | ECS field copied from the source document when available.
|`tags`|`tags`| ECS field copied from the source document when available.
|`labels`| `labels`| ECS field copied from the source document when available.
|`ecs.version` |`ecs.version`| ECS field, should NOT be copied from source documents.
|`signal.ancestors.*`|`kibana.alert.ancestors.*`|
|`signal.depth`| `kibana.alert.depth`|
|`signal.original_event.*` | `kibana.alert.original_event.*`|
|`signal.original_time`|`kibana.alert.original_time`|
|`signal.reason` |`kibana.alert.reason`|
|`signal.rule.author` |`kibana.alert.rule.author`|
|`signal.rule.building_block_type`|`kibana.alert.building_block_type`||`signal.rule.created_at`|`kibana.alert.rule.created_at`|
|`signal.rule.created_by` |`kibana.alert.rule.created_by`|
|`signal.rule.description` |`kibana.alert.rule.description`|
|`signal.rule.enabled` |`kibana.alert.rule.enabled`|
|`signal.rule.false_positives`| `kibana.alert.rule.false_positives`|
|`signal.rule.from` |`kibana.alert.rule.from`|
|`signal.rule.id` |`kibana.alert.rule.uuid` |
|`signal.rule.immutable` |`kibana.alert.rule.immutable`|
|`signal.rule.interval` |`kibana.alert.rule.interval`|
|`signal.rule.license` |`kibana.alert.rule.license`|
|`signal.rule.max_signals`|`kibana.alert.rule.max_signals`|
|`signal.rule.name` |`kibana.alert.rule.name` |
|`signal.rule.note` |`kibana.alert.rule.note`|
|`signal.rule.references` |`kibana.alert.rule.references`|
|`signal.rule.risk_score` |`kibana.alert.risk_score`|
|`signal.rule.rule_id` |`kibana.alert.rule.rule_id`|
|`signal.rule.rule_name_override`|`kibana.alert.rule.rule_name_override`|
|`signal.rule.severity` |`kibana.alert.severity`|
|`signal.rule.tags` |`kibana.alert.rule.tags`|
|`signal.rule.threat.*` |`kibana.alert.rule.threat.*`|
|`signal.rule.timeline_id` |`kibana.alert.rule.timeline_id`|
|`signal.rule.timeline_title`|`kibana.alert.rule.timeline_title`|
|`signal.rule.timestamp_override`|`kibana.alert.rule.timestamp_override`|
|`signal.rule.to` |`kibana.alert.rule.to`|
|`signal.rule.type` |`kibana.alert.rule.type`|
|`signal.rule.updated_at` |`kibana.alert.rule.updated_at`|
|`signal.rule.updated_by` |`kibana.alert.rule.updated_by`|
|`signal.rule.version` |`kibana.alert.rule.version`|
|`signal.status` |`kibana.alert.workflow_status`|
|`signal.threshold_result.*`|`kibana.alert.threshold_result.*`|
|`signal.group.id` |`kibana.alert.group.id`|
|`signal.group.index` |`kibana.alert.group.index`|
|`signal.rule.index` |`kibana.alert.rule.parameters.index`|
|`signal.rule.language`|`kibana.alert.rule.parameters.language`|
|`signal.rule.query` |`kibana.alert.rule.parameters.query`|
|`signal.rule.risk_score_mapping`|`kibana.alert.rule.parameters.risk_score_mapping`|
|`signal.rule.saved_id`| `kibana.alert.rule.parameters.saved_id`|
|`signal.rule.severity_mapping`|`kibana.alert.rule.parameters.severity_mapping`|
|`signal.rule.threat_filters`|`kibana.alert.rule.parameters.threat_filters`|
|`signal.rule.threat_index`|`kibana.alert.rule.parameters.threat_index`|
|`signal.rule.threat_indicator_path`|`kibana.alert.rule.parameters.threat_indicator_path`|
|`signal.rule.threat_language`|`kibana.alert.rule.parameters.threat_language`|
|`signal.rule.threat_mapping.*`|`kibana.alert.rule.parameters.threat_mapping.*`|
|`signal.rule.threat_query`|`kibana.alert.rule.parameters.threat_query`|
|`signal.rule.threshold.*` |`kibana.alert.rule.parameters.threshold.*` |

|==============================================
