[[alert-schema]]

== Alert schema

{elastic-sec} stores alerts that have been generated by detection rules in hidden {es} indices.  In 7.x versions, the index pattern was `.siem-signals-<spacename>-*`.  In 8.x versions, the index pattern is `.alerts-security.alerts-<spacename>-*`, and the field names have changed. The following table includes the new names and provides a cross-reference to the previous field names.

NOTE: Users are advised NOT to use the `_source field` in alert documents, but rather use the fields API to programmatically obtain the list of fields used in these documents. Learn more about {ref}/search-fields.html[retrieving selected fields from a search].

|==============================================
|Legacy signal field |Alerts-as-data field | Description

|{ecs-ref}/ecs-base.html#field-timestamp[`@timestamp`] |`@timestamp` | ECS field, represents the time when the alert was created or most recently updated.
|{ecs-ref}/ecs-base.html#field-message[`message`]| `message` | ECS field copied from the source document when available.
|{ecs-ref}/ecs-base.html#field-tags[`tags`]|`tags`| ECS field copied from the source document when available.
|{ecs-ref}/ecs-base.html#field-labels[`labels`]| `labels`| ECS field copied from the source document when available.
|{ecs-ref}/ecs-ecs.html#field-ecs-version[`ecs.version`] |`ecs.version`| ECS field, should NOT be copied from source documents.
|{ecs-ref}/ecs-allowed-values-event-kind.html[`event.kind`]|`event.kind`| ECS field, always `signal` for alert documents, and `event` or `metric` as appropriate for evaluation documents.
|{ecs-ref}/ecs-allowed-values-event-category.html[`event.category`]| `event.category`| ECS field, copied from the source document when available.
|{ecs-ref}/ecs-allowed-values-event-type.html[`event.type`]|`event.type`| ECS field, copied from the source document when available.
|{ecs-ref}/ecs-allowed-values-event-outcome.html[`event.outcome`]|`event.outcome` | ECS field, copied from the source document when available.
|{ecs-ref}/ecs-agent.html[`agent.*`]| `agent.*`| ECS `agent.*` fields copied from the source document when available.
|{ecs-ref}/ecs-client.html[`client.*`] | `client.*` | ECS `client.*` fields copied from the source document when available.
|{ecs-ref}/ecs-cloud.html[`cloud.*`] |`cloud.*` | ECS `cloud.*` fields copied from the source document when available.
|{ecs-ref}/ecs-container.html[`container.*`] | `container.*` | ECS `container.* fields` copied from the source document when available.
|{ecs-ref}/ecs-data_stream.html[`data_stream.*`] |`data_stream.*`| ECS `data_stream.*` fields copied from the source document when available.

NOTE: These fields may be constant keywords in the source documents, but they need to be copied into the alerts documents as keywords.

|{ecs-ref}/ecs-destination.html[`destination.*`] | `destination.*`|ECS `destination.*` fields copied from the source document when available.
|{ecs-ref}/ecs-dll.html[`dll.*`] |`dll.*`| ECS `dll.*` fields copied from the source document when available.
|{ecs-ref}/ecs-dns.html[`dns.*`] | dns.* | ECS `dns.*` fields copied from the source document when available.
|{ecs-ref}/ecs-error.html[`error.*`]| `error.*` |ECS `error.*` fields copied from the source document when available.
|{ecs-ref}/ecs-event.html[`event.*`] | `event.*`| ECS `event.*` fields copied from the source document when available.

NOTE: categorization fields above (`event.kind`, `event.category`, `event.type`, `event.outcome`) are listed separately above.

|{ecs-ref}/ecs-file.html[`file.*`]| `file.*` | ECS `file.*` fields copied from the source document when available.
|{ecs-ref}/ecs-group.html[`group.*`] | `group.*` | ECS `group.*` fields copied from the source document when available.
|{ecs-ref}/ecs-host.html[`host.*`] | `host.*` |ECS `host.*` fields copied from the source document when available.
|{ecs-ref}/ecs-http.html[`http.*`]| `http.*`| ECS `http.*` fields copied from the source document when available.
|{ecs-ref}/ecs-log.html[`log.*`]| `log.*` | ECS `log.*` fields copied from the source document when available.
|{ecs-ref}/ecs-network.html[`network.*`]|`network.*`| ECS `network.*` fields copied from the source document when available.
|{ecs-ref}/ecs-observer.html[`observer.*`]|`observer.*`|ECS `observer.*` fields copied from the source document when available.
|{ecs-ref}/ecs-orchestrator.html[`orchestrator.*`] | `orchestrator.*`| ECS `orchestrator.*` fields copied from the source document when available.
|{ecs-ref}/ecs-organization.html[`organization.*`]| `organization.*`| ECS `organization.*` fields copied from the source document when available.
|{ecs-ref}/ecs-package.html[`package.*`]|`package.*`|ECS `package.*` fields copied from the source document when available.
|{ecs-ref}/ecs-process.html[`process.*`]| `process.*`| ECS `process.*` fields copied from the source document when available.
|{ecs-ref}/ecs-registry.html[`registry.*`] | `registry.*`| ECS `registry.*` fields copied from the source document when available.
|{ecs-ref}/ecs-related.html[`related.*`] |`related.*` |ECS `related.*` fields copied from the source document when available.
|{ecs-ref}/ecs-rule.html[`rule.*`]| `rule.*`| ECS `rule.*` fields copied from the source document when available.

NOTE: These fields are not related to the detection rule that generated the alert.

|{ecs-ref}/ecs-server.html[`server.*`] |`server.*`|ECS `server.*` fields copied from the source document when available.
|{ecs-ref}/ecs-service.html[`service.*`]|`service.*`|ECS `service.*` fields copied from the source document when available.
|{ecs-ref}/ecs-source.html[`source.*`] | `source.*` | ECS `source.*` fields copied from the source document when available.
|{ecs-ref}/ecs-tracing.html#field-span-id[`span.*`] |`span.*`|ECS `span.*` fields copied from the source document when available.
|{ecs-ref}/ecs-threat.html[`threat.*`]| `threat.*`|ECS `threat.*` fields copied from the source document when available.
|{ecs-ref}/ecs-tls.html[`tls.*`] | `tls.*`| ECS `tls.*` fields copied from the source document when available.
|{ecs-ref}/ecs-tracing.html[`trace.*`]| `trace.*`|ECS `trace.*` fields copied from the source document when available.
|{ecs-ref}/ecs-tracing.html#field-transaction-id[`transaction.*`]|`transaction.*`| ECS `transaction.*` fields copied from the source document when available.
|{ecs-ref}/ecs-url.html[`url.*`]|`url.*`|ECS `url.*` fields copied from the source document when available.
|{ecs-ref}/ecs-user.html[`user.*`]|`user.*`| ECS `user.*` fields copied from the source document when available.
|{ecs-ref}/ecs-user_agent.html[`user_agent.*`]|`user_agent.*`| ECS `user_agent.*` fields copied from the source document when available.
|{ecs-ref}/ecs-vulnerability.html[`vulnerability.*`]|`vulnerability.*`|ECS `vulnerability.*` fields copied from the source document when available.
|`signal.ancestors.*`|`kibana.alert.ancestors.*`|
|`signal.depth`| `kibana.alert.depth`|
|`signal.original_event.*` | `kibana.alert.original_event.*`|
|`signal.original_time`|`kibana.alert.original_time`| The value copied from the source event (`@timestamp`).
|`signal.reason` |`kibana.alert.reason`|
|`signal.rule.author` |`kibana.alert.rule.author`|
|`signal.rule.building_block_type`|`kibana.alert.building_block_type`||`signal.rule.created_at`|`kibana.alert.rule.created_at`|
|`signal.rule.created_by` |`kibana.alert.rule.created_by`|
|`signal.rule.description` |`kibana.alert.rule.description`|
|`signal.rule.enabled` |`kibana.alert.rule.enabled`|
|`signal.rule.false_positives`| `kibana.alert.rule.false_positives`|
|`signal.rule.from` |`kibana.alert.rule.from`|
|`signal.rule.id` |`kibana.alert.rule.uuid` |
|`signal.rule.immutable` |`kibana.alert.rule.immutable`|
|`signal.rule.interval` |`kibana.alert.rule.interval`|
|`signal.rule.license` |`kibana.alert.rule.license`|
|`signal.rule.max_signals`|`kibana.alert.rule.max_signals`|
|`signal.rule.name` |`kibana.alert.rule.name` |
|`signal.rule.note` |`kibana.alert.rule.note`|
|`signal.rule.references` |`kibana.alert.rule.references`|
|`signal.rule.risk_score` |`kibana.alert.risk_score`|
|`signal.rule.rule_id` |`kibana.alert.rule.rule_id`|
|`signal.rule.rule_name_override`|`kibana.alert.rule.rule_name_override`|
|`signal.rule.severity` |`kibana.alert.severity`| Alert severity, populated by the `rule_type` at alert creation. Must have a value of `low`, `medium`, `high`, `critical`.
|`signal.rule.tags` |`kibana.alert.rule.tags`|
|`signal.rule.threat.*` |`kibana.alert.rule.threat.*`|
|`signal.rule.timeline_id` |`kibana.alert.rule.timeline_id`|
|`signal.rule.timeline_title`|`kibana.alert.rule.timeline_title`|
|`signal.rule.timestamp_override`|`kibana.alert.rule.timestamp_override`|
|`signal.rule.to` |`kibana.alert.rule.to`|
|`signal.rule.type` |`kibana.alert.rule.type`|
|`signal.rule.updated_at` |`kibana.alert.rule.updated_at`|
|`signal.rule.updated_by` |`kibana.alert.rule.updated_by`|
|`signal.rule.version` |`kibana.alert.rule.version`|
|`signal.status` |`kibana.alert.workflow_status`|
|`signal.threshold_result.*`|`kibana.alert.threshold_result.*`|
|`signal.group.id` |`kibana.alert.group.id`|
|`signal.group.index` |`kibana.alert.group.index`|
|`signal.rule.index` |`kibana.alert.rule.parameters.index`|
|`signal.rule.language`|`kibana.alert.rule.parameters.language`|
|`signal.rule.query` |`kibana.alert.rule.parameters.query`|
|`signal.rule.risk_score_mapping`|`kibana.alert.rule.parameters.risk_score_mapping`|
|`signal.rule.saved_id`| `kibana.alert.rule.parameters.saved_id`|
|`signal.rule.severity_mapping`|`kibana.alert.rule.parameters.severity_mapping`|
|`signal.rule.threat_filters`|`kibana.alert.rule.parameters.threat_filters`|
|`signal.rule.threat_index`|`kibana.alert.rule.parameters.threat_index`| Names of the indicator indices.
|`signal.rule.threat_indicator_path`|`kibana.alert.rule.parameters.threat_indicator_path`|
|`signal.rule.threat_language`|`kibana.alert.rule.parameters.threat_language`|
|`signal.rule.threat_mapping.*`|`kibana.alert.rule.parameters.threat_mapping.*`|Controls which fields will be compared in the indicator and source documents.
|`signal.rule.threat_query`|`kibana.alert.rule.parameters.threat_query`|
|`signal.rule.threshold.*` |`kibana.alert.rule.parameters.threshold.*` |

|==============================================
