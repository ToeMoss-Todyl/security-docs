---
id: serverlessSecurityEnvironmentVariableCapture
slug: /serverless/security/environment-variable-capture
title: Capture environment variables
# description: Description to be written
tags: []
status: rough content
---

import RoughContent from '../partials/rough-content-notice.mdx'

<RoughContent />

<div id="environment-variable-capture"></div>

<DocCallOut title="Requirements">

* This feature requires ((stack)) version 8.6 or higher.
* In ((stack)) version 8.6, this feature is only available for Linux.

</DocCallOut>

You can configure an ((agent)) policy to capture up to five environment variables (`env vars`).

<DocCallOut title="Note">

* Env var names must be no more than 63 characters, and env var values must be no more than 1023 characters. Values outside these limits are silently ignored.

* Env var names are case sensitive in Linux.

</DocCallOut>

To set up environment variable capture for an ((agent)) policy:

1. Go to **Security -> Manage -> Policies**.
1. Select an ((agent)) policy.
1. Click **Show advanced settings**.
1. Scroll down or search for `linux.advanced.capture_env_vars`.
1. Enter the names of env vars you want to capture, separated by commas. For example: `PATH,USER`
1. Click **Save**.

![The "linux.advanced.capture_env_vars" advanced agent policy setting](../images/environment-variable-capture/-cloud-native-security-env-var-capture.png)

<div id="find-cap-env-vars"></div>

## Find captured environment variables
Captured environment variables are associated with process events, and appear in each event's `process.env_vars` field.

To view environment variables in the **Events** table:

1. Click the **Events** tab on the **Hosts**, **Network**, or **Users** pages (*Security -> Explore*), then click **Fields** in the Events table.
1. Search for the `process.env_vars` field, select it, and click **Close**.
    A new column appears containing captured environment variable data.

![The Events table with the "process.env_vars" column highlighted](../images/environment-variable-capture/-cloud-native-security-env-var-capture-detail.png)
