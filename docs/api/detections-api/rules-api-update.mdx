---
id: serverlessSecurityRulesApiUpdate
# slug: /serverless/security/rules-api-update
title: Update rule
# description: Description to be written
tags: [ 'serverless', 'security', 'reference' ]
status: rough content
---

<div id="rules-api-update"></div>

<DocCallOut title="Warning" color="warning">
This API supports [Token-based authentication](((kibana-ref))/api.html#token-api-authentication) only.
</DocCallOut>

Updates an existing detection rule.

You can use `PUT` or `PATCH` methods to update rules, where:

* `PUT` replaces the original rule and deletes fields that are not specified.
* `PATCH` updates the specified fields.

## Request URL

`PUT <kibana host>:<port>/api/detection_engine/rules`

`PATCH <kibana host>:<port>/api/detection_engine/rules`

## Request body

A JSON object with:

* The `id` or `rule_id` field of the rule you want to update.
* The fields you want to modify.

<DocCallOut title="Important" color="warning">
If you call `PUT` to update a rule, all unspecified fields are
deleted. You cannot modify the `id` or `rule_id` values.
</DocCallOut>

For `PATCH` calls any of the fields can be modified, whereas for `PUT` calls
some fields are required.

### Fields required for `PUT` calls

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>description</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      The rule's description.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>name</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      The rule's name.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>risk_score</DocCell>
    <DocCell>Integer</DocCell>
    <DocCell>
      A numerical representation of the alert's severity from
      0 to 100, where:
      
      * `0` - `21` represents low severity
      * `22` - `47` represents medium severity
      * `48` - `73` represents high severity
      * `74` - `100` represents critical severity

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>severity</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Severity level of alerts produced by the rule, which must
      be one of the following:
      
      * `low`: Alerts that are of interest but generally not considered to be
          security incidents

      * `medium`: Alerts that require investigation
      * `high`: Alerts that require immediate investigation
      * `critical`: Alerts that indicate it is highly likely a security incident has
          occurred

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>type</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Data type on which the rule is based:
      
      * `eql`: EQL query (see [Event Query Language](((ref))/eql.html)).
      * `query`: query with or without additional filters.
      * `saved_query`: saved search, identified in the `saved_id` field.
      * `machine_learning`: rule based on a ((ml)) job's anomaly scores.
      * `threat_match`: rule that matches event values with values in the specified
          ((es)) index.
      * `threshold`: rule based on the number of times a `query` matches the
          specified field.
      * `new_terms`: rule that alerts on values that have not been seen before.
    </DocCell>
  </DocRow>
</DocTable>

### Field required for query, threat-match, threshold, and new terms rules `PUT` calls

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>query</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      [Query](((kibana-ref))/search.html) used by the rule to create
      alerts. For threat-match rules, only the query's results are used to determine
      whether an alert is generated.
      
      
    </DocCell>
  </DocRow>
</DocTable>

### Field required for threshold rules `PUT` calls

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>threshold</DocCell>
    <DocCell>Object</DocCell>
    <DocCell>
      Defines the field and threshold value for when alerts
      are generated, where:
      
      * `cardinality` (Array of length 1): The field on which the cardinality is applied.
      * `cardinality.field` (string, required): The field on which to calculate and compare the
          cardinality.

      * `cardinality.value` (integer, required): The threshold value from which an alert is
          generated based on unique number of values of `cardinality.field`.

      * `field` (string or string[], required): The field on which the threshold is applied. If
          you specify an empty array (`[]`), alerts are generated when the query returns
          at least the number of results specified in the `value` field.

      * `value` (integer, required): The threshold value from which an alert is
          generated.

      
      
    </DocCell>
  </DocRow>
</DocTable>

### Field required for saved-query rules `PUT` calls

| Name | Type | Description |
|---|---|---|
| saved_id | String | Kibana saved search used by the rule to create alerts. |

### Field required for EQL rules `PUT` calls

| Name | Type | Description |
|---|---|---|
| language | String | Must be `eql`. |

### Fields required for machine-learning rules `PUT` calls

| Name | Type | Description |
|---|---|---|
| anomaly_threshold | Integer | Anomaly score threshold above which the rule creates an alert. Valid values are from `0` to `100`. |
| machine_learning_job_id | String | ((ml-cap)) job ID the rule monitors for anomaly scores. |

### Fields required for threat-match rules `PUT` calls

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>threat_index</DocCell>
    <DocCell>String[]</DocCell>
    <DocCell>
      ((es)) indices used to check which field values generate
      alerts.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>threat_query</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Query used to determine which fields in the ((es)) index
      are used for generating alerts.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>threat_mapping</DocCell>
    <DocCell>Object[]</DocCell>
    <DocCell>
      Array of `entries` objects that define mappings
      between the source event fields and the values in the ((es)) threat index. Each
      `entries` object must contain these fields:
      
      * `field`: field from the event indices on which the rule runs
      * `type`: must be `mapping`
      * `value`: field from the ((es)) threat index

      
      You can use Boolean `and` and `or` logic to define the conditions for when
      matching fields and values generate alerts. Sibling `entries` objects
      are evaluated using `or` logic, whereas multiple entries in a single `entries`
      object use `and` logic. See <DocLink id="serverlessSecurityRulesApiCreate" section="threat-match-example">below</DocLink> for an example that
      uses both `and` and `or` logic.
      
      
    </DocCell>
  </DocRow>
</DocTable>

### Fields required for new terms rules `PUT` calls

<DocTable columns={[{ "title": "Name" }, { "title": "Type" }, { "title": "Description" }]}>
  <DocRow>
    <DocCell>new_terms_fields</DocCell>
    <DocCell>String[]</DocCell>
    <DocCell>Fields to monitor for new values. Must contain 1–3 field names.</DocCell>
  </DocRow>
  <DocRow>
    <DocCell>history_window_start</DocCell>
    <DocCell>String</DocCell>
    <DocCell>Start date to use when checking if a term has been seen before. Supports relative dates – for example, `now-30d` will search the last 30 days of data when checking if a term is new. We do not recommend using absolute dates, which can cause issues with rule performance due to querying increasing amounts of data over time.</DocCell>
  </DocRow>
</DocTable>

### Optional fields for all rule types

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>actions</DocCell>
    <DocCell><DocLink id="serverlessSecurityRulesApiCreate" section="actions-schema">actions[]</DocLink></DocCell>
    <DocCell>
      Array defining the automated
      actions (notifications) taken when alerts are generated.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>author</DocCell>
    <DocCell>String[]</DocCell>
    <DocCell>
      The rule's author.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>building_block_type</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Determines if the rule acts as a building block.
      By default, building-block alerts are not displayed in the UI. These rules are
      used as a foundation for other rules that do generate alerts. Its value must be
      `default`. For more information, refer to <DocLink id="serverlessSecurityBuildingBlockRule" />.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>enabled</DocCell>
    <DocCell>Boolean</DocCell>
    <DocCell>
      Determines whether the rule is enabled. Defaults to `true`.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>false_positives</DocCell>
    <DocCell>String[]</DocCell>
    <DocCell>
      String array used to describe common reasons why
      the rule may issue false-positive alerts. Defaults to an empty array.
      
       <span id="detection-rules-from"></span> 
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>from</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Time from which data is analyzed each time the rule executes,
      using a [date math range](((ref))/common-options.html#date-math). For example,
      `now-4200s` means the rule analyzes data from 70 minutes before its start
      time. Defaults to `now-6m` (analyzes data from 6 minutes before the start
      time).
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>interval</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Frequency of rule execution, using a
      [date math range](((ref))/common-options.html#date-math). For example, `"1h"`
      means the rule runs every hour. Defaults to `5m` (5 minutes).
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>license</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      The rule's license.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>max_signals</DocCell>
    <DocCell>Integer</DocCell>
    <DocCell>
      Maximum number of alerts the rule can create during a
      single execution. Defaults to `100`.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>meta</DocCell>
    <DocCell>Object</DocCell>
    <DocCell>
      Placeholder for metadata about the rule.
      
      **NOTE**: This field is overwritten when you save changes to the rule's settings.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>note</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Notes to help investigate alerts produced by the rule.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>references</DocCell>
    <DocCell>String[]</DocCell>
    <DocCell>
      Array containing notes about or references to
      relevant information about the rule. Defaults to an empty array.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>tags</DocCell>
    <DocCell>String[]</DocCell>
    <DocCell>
      String array containing words and phrases to help categorize,
      filter, and search rules. Defaults to an empty array.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>threat</DocCell>
    <DocCell><DocLink id="serverlessSecurityRulesApiCreate" section="threat-schema">threat[]</DocLink></DocCell>
    <DocCell>
      Object containing attack
      information about the type of threat the rule monitors, see
      [ECS threat fields](((ecs-ref))/ecs-threat.html). Defaults to an empty array.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>throttle</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Determines how often actions are taken:
           
      <DocCallOut title="Note">
      
      The rule level `throttle` field is deprecated in ((elastic-sec)) 8.8 and will remain active for at least the next 12 months.
      
      In ((elastic-sec)) 8.8 and later, you can use the (<DocLink id="serverlessSecurityBulkActionsRulesApi" section="optional-action-fields">`frequency`</DocLink>) field to define frequencies for individual actions. Actions without frequencies will acquire a converted version of the rule's `throttle` field. In the response, the converted `throttle` setting appears in the individual actions' `frequency` field.
      
      </DocCallOut>
      
      
      * `no_actions`: Never
      * `rule`: Every time new alerts are detected
      * `1h`: Every hour
      * `1d`: Every day
      * `7d`: Every week

      
      Required when `actions` are used to send notifications.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>version</DocCell>
    <DocCell>Integer</DocCell>
    <DocCell>
      The rule's version number. If this is not provided, the
      rule's version number is incremented by 1.
      
      `PATCH` calls enabling and disabling the rule do not increment its version
      number.
      
      
    </DocCell>
  </DocRow>
</DocTable>

### Optional fields for query, threat-match, EQL, and new terms rules

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>exceptions_list</DocCell>
    <DocCell>Object[]</DocCell>
    <DocCell>
      Array of
      <DocLink id="serverlessSecurityExceptionsApiOverview">exception containers</DocLink>, which define
      exceptions that prevent the rule from generating alerts even when its other
      criteria are met. The object has these fields:
      
      * `id` (string, required): ID of the exception container.
      * `list_id` (string, required): List ID of the exception container.
      * `namespace_type` (string required): Determines whether the exceptions are
          valid in only the rule's ((kib)) space (`single`) or in all ((kib)) spaces
          (`agnostic`).

      * `type` (string, required): The exception type, which must be either
          a detection rule exception (`detection`) or an endpoint exception (`endpoint`).

      
    </DocCell>
  </DocRow>
</DocTable>

### Optional fields for threat-match rules

| Name | Type | Description |
|---|---|---|
| threat_filters | Object[] | [Query and filter context](((ref))/query-filter-context.html) array used to filter documents from the ((es)) index containing the threat values. |
| threat_indicator_path | String | Much like an ingest processor, users can use this field to define where their threat indicator can be found on their indicator documents. Defaults to `threatintel.indicator`. |

### Optional fields for query, threat-match, threshold, and new terms rules

| Name | Type | Description |
|---|---|---|
| language | String | Determines the query language, which must be `kuery` or `lucene`. Defaults to `kuery`. |

### Optional fields for EQL, query, threshold, and new terms rules

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>filters</DocCell>
    <DocCell>Object[]</DocCell>
    <DocCell>
      The [query and filter
      context](((ref))/query-filter-context.html) array used to define the conditions for when alerts are created from
      events. Defaults to an empty array.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>index</DocCell>
    <DocCell>String[]</DocCell>
    <DocCell>
      Indices on which the rule functions. Defaults to the
      Security Solution indices defined on the ((kib)) Advanced Settings page
      (**Project Settings** → **Management** → **Advanced Settings** →
      `securitySolution:defaultIndex`).
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>risk_score_mapping</DocCell>
    <DocCell>Object[]</DocCell>
    <DocCell>
      Overrides generated alerts' `risk_score` with
      a value from the source event:
      
      * `field` (string, required): Source event field used to override the default
          `risk_score`. This field must be an integer.

      * `operator` (string, required): Must be `equals`.
      * `value`(string, required): Must be an empty string (`""`).

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>rule_name_override</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Sets which field in the source event is used to
      populate the alert's `signal.rule.name` value (in the UI, this value is
      displayed on the **Rules** page in the **Rule** column). When unspecified, the
      rule's `name` value is used. The source field must be a string data type.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>severity_mapping</DocCell>
    <DocCell>Object[]</DocCell>
    <DocCell>
      Overrides generated alerts' `severity` with
      values from the source event:
      
      * `field` (string, required): Source event field used to override the default
          `severity`.

      * `operator` (string, required): Must be `equals`.
      * `severity` (string, required): Mapped severity value, must be `low`,
          `medium`, `high`, or `critical`.

      * `value`(string, required): Field value used to determine the `severity`.

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>timestamp_override</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Sets the time field used to query indices.
      When unspecified, rules query the `@timestamp` field. The source field
      must be an ((es)) date data type.
      
      
    </DocCell>
  </DocRow>
</DocTable>

<div id="opt-fields-eql-update"></div>

### Optional fields for EQL rules

| Name | Type | Description |
|---|---|---|
| event_category_field | String | Contains the event classification, such as `process`, `file`, or `network`. This field is typically mapped as a field type in the [keyword family](((ref))/keyword.html). Defaults to the `event.category` ECS field. |
| tiebreaker_field | String | Sets a secondary field for sorting events (in ascending, lexicographic order) if they have the same timestamp. |
| timestamp_field | String | Contains the event timestamp used for sorting a sequence of events. This is different from `timestamp_override`, which is used for querying events within a range. Defaults to the `@timestamp` ECS field. |

<div id="actions-object-schema-update"></div>

### `actions` schema

These fields are required when calling `PUT` to modify the `actions` object:

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>action_type_id</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      The action type used for sending notifications, can
      be:
      
      * `.slack`
      * `.email`
      * `.pagerduty`
      * `.webhook`

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>group</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Optionally groups actions by use cases. Use `default` for alert
      notifications.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>id</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      The connector ID.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>params</DocCell>
    <DocCell>Object</DocCell>
    <DocCell>
      Object containing the allowed connector fields, which varies according to the connector type:
      
      * For Slack:
          * `message` (string, required): The notification message.
      * For email:
          * `to`, `cc`, `bcc` (string): Email addresses to which the notifications are
              sent. At least one field must have a value.

          * `subject` (string, optional): Email subject line.
          * `message` (string, required): Email body text.
      * For Webhook:
          * `body` (string, required): JSON payload.
      * For PagerDuty:
          * `severity` (string, required): Severity of on the alert notification, can
              be: `Critical`, `Error`, `Warning` or `Info`.

          * `eventAction` (string, required):  Event [action type](https://v2.developer.pagerduty.com/docs/events-api-v2#event-action), which can be `trigger`,
              `resolve`, or `acknowledge`.

          * `dedupKey` (string, optional): Groups alert notifications with the same
              PagerDuty alert.

          * `timestamp` (DateTime, optional): [ISO-8601 format timestamp](https://v2.developer.pagerduty.com/v2/docs/types#datetime).
          * `component` (string, optional): Source machine component responsible for the
              event, for example `security-solution`.

          * `group` (string, optional): Enables logical grouping of service components.
          * `source` (string, optional): The affected system. Defaults to the ((kib))
              saved object ID of the action.

          * `summary` (string, options): Summary of the event. Defaults to
              `No summary provided`. Maximum length is 1024 characters.

          * `class` (string, optional): Value indicating the class/type of the event.

      
      
    </DocCell>
  </DocRow>
</DocTable>

<div id="optional-actions-fields-rule-update"></div>

### Optional `action` fields

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>frequency</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Object containing an action’s frequency:
      
      * `summary` (Boolean, required): Defines whether to send notifications as a summary of alerts or for each generated alert.

      
      * `notifyWhen` (String, required`): Defines how often alerts generate actions. Valid values are:

      
          * `onActiveAlert`: Actions run when the alert is generated.
          * `onThrottleInterval`: Actions run on the specified throttle interval and summarize new alerts generated during that interval.

      
      * `throttle` (String, optional): Defines how often an alert generates repeated actions. This custom action interval must be specified in seconds, minutes, hours, or days. For example, `10m` or `1h`. This property is used only if `notifyWhen` is `onThrottleInterval`.

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>alerts_filter</DocCell>
    <DocCell>Object</DocCell>
    <DocCell>
      Object containing an action’s conditional filters:
      
      * `timeframe` (Object, optional): Object containing the time frame for when this action can be run.

      
          * `days` (Array of integers, required): List of days of the week on which this action can be run. Days of the week are expressed as numbers between `1-7`, where `1` is Monday and `7` is Sunday. To select all days of the week, enter an empty array.
          * `hours` (Object, required): The hours of the day during which this action can run. Hours of the day are expressed as two strings in the format `hh:mm` in `24` hour time. A start of `00:00` and an end of `24:00` means the action can run all day.
              * `start` (String, required)
              * `end` (String, required)

      
          * `timezone` (String, required): An ISO timezone name, such as `Europe/Madrid` or `America/New_York`. Specific offsets such as UTC or UTC+1 will also work, but lack built-in DST.

      
      * `query` (Object, optional): Object containing a query filter which gets applied to an action and determines whether the action should run. 
          * `kql` (String, required): A KQL string.
          * `filters` (Array of objects, required): A filter object, as defined in the `kbn-es-query` package.

      
      
    </DocCell>
  </DocRow>
</DocTable>

<div id="threats-object-update"></div>

### `threat` schema

These fields are required when calling `PUT` to modify the `threat` object:

<DocTable columns={[
  {
    "title": "Name",
    "width": "33.333333333333336%"
  },
  {
    "title": "Type",
    "width": "33.333333333333336%"
  },
  {
    "title": "Description",
    "width": "33.333333333333336%"
  }
]}>
  <DocRow>
    <DocCell>framework</DocCell>
    <DocCell>String</DocCell>
    <DocCell>
      Relevant attack framework.
      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>tactic</DocCell>
    <DocCell>Object</DocCell>
    <DocCell>
      Object containing information on the attack type:
      
      * `id` - string, required
      * `name` - string, required
      * `reference` - string, required

      
      
    </DocCell>
  </DocRow>
  <DocRow>
    <DocCell>technique</DocCell>
    <DocCell>Object</DocCell>
    <DocCell>
      Object containing information on the attack
      technique:
      
      * `id` - string, required
      * `name` - string, required
      * `reference` - string, required
      
      
    </DocCell>
  </DocRow>
</DocTable>

<DocCallOut title="Note">
Only threats described using the MITRE ATT&CK<sup>TM</sup> framework are displayed
in the UI (*Manage* → **Rules** → **_Rule name_**).
</DocCallOut>

### Example request

Updates the `threat` object:

```console
PATCH api/detection_engine/rules
{
  "rule_id": "process_started_by_ms_office_program_possible_payload",
  "threat": [
   {
      "framework": "MITRE ATT&CK",
      "tactic": {
         "id": "TA0001",
         "reference": "https://attack.mitre.org/tactics/TA0001",
         "name": "Initial Access"
      },
      "technique": [
         {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193"
         }
      ]
   }
  ]
}
```
{/* KIBANA */}

## Response code

`200` 
    : Indicates a successful call.

## Response payload

The rule's updated JSON object, including the time the rule was updated and an
incremented version number.

Example response:

```json
{
  "created_at": "2020-01-05T09:56:11.805Z",
  "updated_at": "2020-01-05T09:59:59.129Z",
  "created_by": "elastic",
  "description": "Process started by MS Office program - possible payload",
  "enabled": false,
  "false_positives": [],
  "filters": [
    {
      "query": {
        "match": {
          "event.action": {
            "query": "Process Create (rule: ProcessCreate)",
            "type": "phrase"
          }
        }
      }
    }
  ],
  "from": "now-6m",
  "id": "4f228868-9928-47e4-9785-9a1a9b520c7f",
  "interval": "5m",
  "rule_id": "process_started_by_ms_office_program_possible_payload",
  "language": "kuery",
  "max_signals": 100,
  "risk_score": 50,
  "name": "MS Office child process",
  "query": "process.parent.name:EXCEL.EXE or process.parent.name:MSPUB.EXE or process.parent.name:OUTLOOK.EXE or process.parent.name:POWERPNT.EXE or process.parent.name:VISIO.EXE or process.parent.name:WINWORD.EXE",
  "references": [],
  "severity": "low",
  "updated_by": "elastic",
  "tags": [
    "child process",
    "ms office"
  ],
  "related_integrations": [],        [^1]
  "required_fields": [],             [^1]
  "setup": "",                       [^1]
  "type": "query",
  "threat": [
    {
      "framework": "MITRE ATT&CK",
      "tactic": {
        "id": "TA0001",
        "reference": "https://attack.mitre.org/tactics/TA0001",
        "name": "Initial Access"
      },
      "technique": [
        {
          "id": "T1193",
          "name": "Spearphishing Attachment",
          "reference": "https://attack.mitre.org/techniques/T1193"
        }
      ]
    }
  ],
  "execution_summary": {                       [^1]
    "last_execution": {
      "date": "2022-03-23T16:06:12.787Z",
      "status": "partial failure",
      "status_order": 20,
      "message": "This rule attempted to query data from Elasticsearch indices listed in the \"Index pattern\" section of the rule definition, but no matching index was found.",
      "metrics": {
          "total_search_duration_ms": 135,
          "total_indexing_duration_ms": 15,
          "execution_gap_duration_s": 0,
      }
    }
  },
  "version": 2
}
```
[^1]: <DocBadge template="in development" />  These fields are under development and their usage or schema may change: `related_integrations`, `required_fields`, `setup`, and `execution_summary`.
