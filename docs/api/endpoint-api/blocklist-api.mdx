---
id: serverlessSecurityBlocklistApi
# slug: /serverless/security/blocklist-api
title: Blocklist
# description: Description to be written
tags: [ 'serverless', 'security', 'reference' ]
status: rough content
---

import EndpointExceptionsRequestPayloadListIdAndNamespaceRequirements from './transclusion/management/api/_exceptions-api-reusable-content/endpoint-exceptions-request-payload-list-id-and-namespace-requirements.mdx'
import CreateExceptionContainerRequestBody from './transclusion/management/api/_exceptions-api-reusable-content/create-exception-container-request-body.mdx'
import EndpointExceptionsRequestPayloadRequirements from './transclusion/management/api/_exceptions-api-reusable-content/endpoint-exceptions-request-payload-requirements.mdx'
import CreateExceptionItemRequestBody from './transclusion/management/api/_exceptions-api-reusable-content/create-exception-item-request-body.mdx'
import UpdateExceptionItemRequestBody from './transclusion/management/api/_exceptions-api-reusable-content/update-exception-item-request-body.mdx'
import ApiIdOrItemidQueryParams from './transclusion/management/api/_exceptions-api-reusable-content/api-id-or-itemid-query-params.mdx'
import FindExceptionItemsQueryParams from './transclusion/management/api/_exceptions-api-reusable-content/find-exception-items-query-params.mdx'
import EndpointExceptionsValueTypesInfoSection from './transclusion/management/api/_exceptions-api-reusable-content/endpoint-exceptions-value-types-info-section.mdx'

<div id="blocklist-api"></div>

export let endpoint_artifact_list_id = "endpoint_blocklists"

export let endpoint_artifact_name = "blocklist entries"

export let endpoint_artifact_name_single = "blocklist entry"

export let endpoint_artifact_name_sentence_start = "Blocklist entries"

export let endpoint_artifact_name_single_sentence_start = "Blocklist entry"

export let endpoint_artifact_api_doc_name = "blocklist"

export let endpoint_artifact_page_title = "Blocklist"

Create, retrieve, update, and delete endpoint <DocLink id="serverlessSecurityBlocklist">blocklist</DocLink> entries with the <DocLink id="serverlessSecurityExceptionsApiOverview">Exceptions API</DocLink>. Endpoint {endpoint_artifact_name} are managed using a static container id (`list_id`) of `pass:a[{endpoint_artifact_list_id}]`, which must be created prior to adding the {endpoint_artifact_name}. To use these APIs, you must have privileges to manage endpoints. Refer to <DocLink id="serverlessSecurityEndpointsPage">Endpoints</DocLink> for more information.

## Create {endpoint_artifact_name} container

`POST <kibana host>:<port>/api/exception_lists`

### Request body

A JSON object containing the fields listed below. The request must have the following:

<EndpointExceptionsRequestPayloadListIdAndNamespaceRequirements
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

- The `type` value must be `endpoint`.

<CreateExceptionContainerRequestBody
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

### Example request

```console
POST api/exception_lists
{
  "description": "((elastic-defend)) Blocklists List",
  "name": "((elastic-defend)) Blocklists List",
  "list_id": "{endpoint_artifact_list_id}",
  "type": "endpoint_blocklists",
  "namespace_type": "agnostic"
}
```
{/* KIBANA */}

### Response code

`200` 
    : Indicates a successful call.

### Response payload

```json
{
 "_version": "WzcsMV0=",
  "created_at": "2020-07-13T09:33:46.187Z",
  "created_by": "elastic",
  "description": "((elastic-defend)) Blocklists List",
  "id": "f320c070-c4eb-11ea-80bb-11861bae2798",
  "immutable": false,
  "list_id": "{endpoint_artifact_list_id}",
  "name": "((elastic-defend)) Blocklists List",
  "namespace_type": "agnostic",
  "os_types": [],
  "tags": [],
  "tie_breaker_id": "2c08d5a5-2ecc-4d5a-acfb-0a367f25b3f3",
  "type": "endpoint_blocklists",
  "updated_at": "2020-07-13T09:33:46.359Z",
  "updated_by": "elastic",
  "version": 1
}
```

<div id="create-{endpoint_artifact_api_doc_name}-item-api"></div>

## Create {endpoint_artifact_name_single}

`POST <kibana host>:<port>/api/exception_lists/items`

### Request body

A JSON object containing the fields listed below. The request must have the following:

<EndpointExceptionsRequestPayloadRequirements
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

<CreateExceptionItemRequestBody
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

#### Example request

```console
POST api/exception_lists/items

{
    "comments": [],
    "description": "some description about this entry",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "list_id": "{endpoint_artifact_list_id}",
    "name": "Some name for this item",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "type": "simple"
}
```
{/* KIBANA */}

### Response code

`200` 
    : Indicates a successful call.

### Response payload

```json
{
    "_version": "WzEzNjIsMV0=",
    "comments": [],
    "created_at": "2022-03-01T16:24:39.471Z",
    "created_by": "elastic",
    "description": "some description about this entry",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "list_id": "{endpoint_artifact_list_id}",
    "name": "Some name for this item",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
    "type": "simple",
    "updated_at": "2022-03-01T16:24:39.475Z",
    "updated_by": "elastic"
}
```

<div id="update-{endpoint_artifact_api_doc_name}-item-api"></div>

## Update {endpoint_artifact_name_single}

`PUT <kibana host>:<port>/api/exception_lists/items`

### Request body

A JSON object containing the fields listed below. The request must have the following:

<EndpointExceptionsRequestPayloadRequirements
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

<UpdateExceptionItemRequestBody
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

#### Example request

Updates the `entries`:

```console
PUT api/exception_lists/items
{
    "_version": "WzEzNjIsMV0=",
    "name": "ABC blocklist",
    "description": "These applications must be blocked",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "comments": [],
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "namespace_type": "agnostic",
    "type": "simple"
}
```
{/* KIBANA */}

### Response code

`200` 
    : Indicates a successful call.

### Response payload

```json
{
    "_version": "WzEzNjcsMV0=",
    "comments": [],
    "created_at": "2022-03-01T16:24:39.471Z",
    "created_by": "elastic",
    "description": "These applications must be blocked",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "list_id": "{endpoint_artifact_list_id}",
    "name": "ABC blocklist",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
    "type": "simple",
    "updated_at": "2022-03-01T17:21:07.273Z",
    "updated_by": "elastic"
}
```

## Delete {endpoint_artifact_name_single}

`DELETE <kibana host>:<port>/api/exception_lists/items`

### URL query parameters

<ApiIdOrItemidQueryParams
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

#### Example request

Deletes the {endpoint_artifact_name_single} with `item_id` of `29f480e6-6d34-4bc7-9038-f809f11cb679`:

```console
DELETE api/exception_lists/items?item_id=29f480e6-6d34-4bc7-9038-f809f11cb679&namespace_type=agnostic
```
{/* KIBANA */}

### Response code

`200` 
    : Indicates a successful call.

### Response payload

The item that was deleted:

```json
{
  "_version": "WzEzNjcsMV0=",
  "comments": [],
  "created_at": "2022-03-01T16:24:39.471Z",
  "created_by": "elastic",
  "description": "These applications must be blocked",
  "entries": [
     {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
      }
  ],
  "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
  "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
  "list_id": "{endpoint_artifact_list_id}",
  "name": "ABC blocklist",
  "namespace_type": "agnostic",
  "os_types": [
    "windows"
  ],
  "tags": [
    "policy:all"
  ],
  "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
  "type": "simple",
  "updated_at": "2022-03-01T17:21:07.273Z",
  "updated_by": "elastic"
}
```

## Retrieve single {endpoint_artifact_name_single}

`GET <kibana host>:<port>/api/exception_lists/items`

### URL query parameters

<ApiIdOrItemidQueryParams
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

#### Example request

```console
GET api/exception_lists/items?item_id=29f480e6-6d34-4bc7-9038-f809f11cb679&namespace_type=agnostic
```
{/* KIBANA */}

### Response code

`200` 
    : Indicates a successful call.

### Response payload

```json
{
  "_version": "WzEzNjcsMV0=",
  "comments": [],
  "created_at": "2022-03-01T16:24:39.471Z",
  "created_by": "elastic",
  "description": "These applications must be blocked",
  "entries": [
    {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
      }
  ],
  "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
  "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
  "list_id": "{endpoint_artifact_list_id}",
  "name": "ABC blocklist",
  "namespace_type": "agnostic",
  "os_types": [
    "windows"
  ],
  "tags": [
    "policy:all"
  ],
  "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
  "type": "simple",
  "updated_at": "2022-03-01T17:21:07.273Z",
  "updated_by": "elastic"
}
```

## Find {endpoint_artifact_name}

`GET <kibana host>:<port>/api/exception_lists/items/_find`

### URL query parameters

<FindExceptionItemsQueryParams
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

#### Example request

```console
GET api/exception_lists/items/_find?page=1&per_page=10&sort_field=name&sort_order=asc&list_id={endpoint_artifact_list_id}&namespace_type=agnostic
```
{/* KIBANA */}

### Response code

`200` 
    : Indicates a successful call.

### Response payload

```json
{
  "data": [
    {
      "_version": "WzEzNjcsMV0=",
      "comments": [],
      "created_at": "2022-03-01T16:24:39.471Z",
      "created_by": "elastic",
      "description": "These applications must be blocked",
      "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
      ],
      "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
      "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
      "list_id": "{endpoint_artifact_list_id}",
      "name": "ABC blocklist",
      "namespace_type": "agnostic",
      "os_types": [
        "windows"
      ],
      "tags": [
        "policy:all"
      ],
      "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
      "type": "simple",
      "updated_at": "2022-03-01T17:21:07.273Z",
      "updated_by": "elastic"
    }
  ],
  "page": 1,
  "per_page": 10,
  "total": 1
}
```

<EndpointExceptionsValueTypesInfoSection
  endpoint_artifact_list_id={endpoint_artifact_list_id}
  endpoint_artifact_name={endpoint_artifact_name}
  endpoint_artifact_name_single={endpoint_artifact_name_single}
  endpoint_artifact_name_sentence_start={endpoint_artifact_name_sentence_start}
  endpoint_artifact_name_single_sentence_start={endpoint_artifact_name_single_sentence_start}
  endpoint_artifact_api_doc_name={endpoint_artifact_api_doc_name}
/>

<div id="exception-{endpoint_artifact_api_doc_name}-item-entry-schema"></div>

### `entry` object schema

At least 3 conditions can be defined on an endpoint blocklist entry. Duplicates are not allowed. The following entries are supported by {endpoint_artifact_name}:

#### File hashes

File hashes are supported by all xref:exception-{endpoint_artifact_api_doc_name}-item-os-types[OS types]. A file hash entry has the following structure:

* `field` : The `file.hash.md5`, `file.hash.sha1` or `file.hash.sha256` values are supported.
* `value` : An array of hash values associated with the `field`.
* `type` : Must be `match_any`.
* `operator` : Must be `included`.

```json
{
    "field": "file.hash.md5",
    "value": [
        "741462ab431a22233C787BAAB9B653C7"
    ],
    "type": "match_any",
    "operator": "included"
}
```

#### Process file path

Process file paths are supported by all xref:exception-{endpoint_artifact_api_doc_name}-item-os-types[OS types]. A file path entry has the following structure:

* `field` : Must be `file.path`.
* `value` : An array of file paths to match on.
* `type` : Must be `match_any`.
* `operator` : Must be `included`.

```json
{
  "field": "file.path",
  "value": "c:/path/to/file.exe",
  "type": "match_any",
  "operator": "included"
}
```

#### Process file signature

Process signature is supported for Windows xref:exception-{endpoint_artifact_api_doc_name}-item-os-types[OS type] only. A signature entry has the following structure:

* `field` : Must be set to `file.Ext.code_signature`.
* `type` : Must be set to `nested`.
* `entries`: An array with 1 `entry` item.
* `entries[0]` : The entry defining the signature to be matched upon:
    * `field`: Must be set to `subject_name`.
    * `value` : An array of signature names to match on.
    * `type` : Must be set to `match_any`.
    * `operator` : Must be set to `included`.

```json
{
    "field": "file.Ext.code_signature",
    "entries": [
        {
            "field": "subject_name",
            "value": [
                "test1",
                "test2"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "type": "nested"
}
```

#### Examples for a Windows {endpoint_artifact_name_single}.

Only one entry of `file.path` or `file.Ext.code_signature` is allowed per blocklist item. The `file.hash.*` entry is also supported and accepts up to three values. The allowed hash types for `file.hash.*` are `md5`, `sha1`, or `sha256`.

```json
[
 {
      "field": "file.hash.md5",
      "value": [
          "741462ab431a22233C787BAAB9B653C7"
      ],
      "type": "match_any",
      "operator": "included"
  },
  {
      "field": "file.hash.sha1",
      "value": [
          "aedb279e378BED6C2DB3C9DC9e12ba635e0b391c"
      ],
      "type": "match_any",
      "operator": "included"
  },
  {
      "field": "file.hash.sha256",
      "value": [
          "a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3"
      ],
      "type": "match_any",
      "operator": "included"
  }
]
```

```json
[
 {
    "field": "file.Ext.code_signature",
    "entries": [
        {
            "field": "subject_name",
            "value": [
                "test1",
                "test2"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "type": "nested"
 }
]
```

```json
[
  {
    "field": "file.path",
    "value": "c:/path/to/file.exe",
    "type": "match_any",
    "operator": "included"
  }
]
```
