---
id: serverlessSecurityValueListsExceptions
slug: /serverless/security/value-lists-exceptions
title: Create and manage value lists
description: Make and manage value lists. 
tags: [ 'serverless', 'security', 'how-to' ]
status: in review
---

<DocBadge template="technical preview" />
<div id="value-lists-exceptions"></div>

Value lists hold multiple values of the same Elasticsearch data type, such as IP addresses, which are used to determine when an exception prevents an alert from being generated. You can use value lists to define exceptions for detection rules; however, you cannot use value lists to define endpoint rule exceptions. 

Value lists are lists of items with the same ((es)) [data type](((ref))/mapping-types.html). You can create value lists with these types:

* `Keywords` (many [ECS fields](((ecs-ref))/ecs-field-reference.html) are keywords)
* `IP Addresses`
* `IP Ranges`
* `Text`

After creating value lists, you can use `is in list` and `is not in list` operators to <DocLink id="serverlessSecurityAddExceptions">define exceptions</DocLink>.

<DocCallOut title="Tip">
You can also use a value list as the <DocLink id="serverlessSecurityRulesUiCreate" section="use-value-lists-with-indicator-match-rules">indicator match index</DocLink> when creating an indicator match rule.
</DocCallOut>

<div id="manage-value-lists"></div>

## Create value lists
When creating a value list for a rule exception, be mindful of the list's size and data type. In general, all rule types support value list exceptions, but there are some limitations for especially large lists or certain data types. The following value list types can _only_ be used with custom query, machine learning, and indicator match rule types:

* Keyword or IP address lists with more than 65,536 values
* IP range lists with more than 200 dash notation values (for example, `127.0.0.1-127.0.0.4` is one value) or more than 65,536 CIDR notation values
* Text data type lists of any size

To create a value list:

1. Prepare a `txt` or `csv` file with all the values you want to use for
    determining exceptions from a single list. If you use a `txt` file, new lines
    act as delimiters.

    <DocCallOut title="Important" color="warning">

    * All values in the file must be of the same ((es)) type.

    * Wildcards are not supported in value lists. Values must be literal values.

    </DocCallOut>

1. Go to **Rules** → **Detection rules (SIEM)**.
1. Click **Import value lists**. The **Import value lists** window opens.

    <DocImage size="xl" url="../images/value-lists-exceptions/-detections-upload-lists-ui.png" alt="Import value lists flyout" />

1. Select the list type (**Keywords**, **IP addresses**, **IP ranges**, or **Text**) from the **Type of value list** drop-down.
1. Drag or select the `csv` or `txt` file that contains the values.
1. Click **Import value list**.

<DocCallOut title="Note">
When the name of the file you are importing already exists, the values in
the new file are appended to the previously imported values.
</DocCallOut>

<div id="edit-value-lists"></div>

## Manage value lists

To view, delete, or export existing value lists:

1. Go to **Rules** → **Detection rules (SIEM)**.
1. Click **Import value lists**. The **Import value lists** window opens.
1. In the **Value lists** table, click the required action button.

<DocImage size="xl" url="../images/value-lists-exceptions/-detections-manage-value-list.png" alt="Import value list flyout with action buttons highlighted" />