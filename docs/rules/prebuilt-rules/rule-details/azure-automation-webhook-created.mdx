---
id: enSecurityAzureAutomationWebhookCreated
slug: /en/security/azure-automation-webhook-created
title: Azure Automation Webhook Created
description: Description to be written
tags: []
---

<div id="azure-automation-webhook-created"></div>

Identifies when an Azure Automation webhook is created. Azure Automation runbooks can be configured to execute via a webhook. A webhook uses a custom URL passed to Azure Automation along with a data payload specific to the runbook. An adversary may create a webhook in order to trigger a runbook that contains malicious code.

**Rule type**: query

**Rule indices**: 

* filebeat-*
* logs-azure*

**Severity**: low

**Risk score**: 21

**Runs every**: 5m

**Searches indices from**: now-25m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="enSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://powerzure.readthedocs.io/en/latest/Functions/operational.html#create-backdoor
* https://github.com/hausec/PowerZure
* https://posts.specterops.io/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a
* https://www.ciraltos.com/webhooks-and-azure-automation-runbooks/

**Tags**: 

* Domain: Cloud
* Data Source: Azure
* Use Case: Configuration Audit
* Tactic: Persistence

**Version**: 102

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Investigation guide

```markdown

```

## Rule query

```js
event.dataset:azure.activitylogs and
  azure.activitylogs.operation_name:
    (
      "MICROSOFT.AUTOMATION/AUTOMATIONACCOUNTS/WEBHOOKS/ACTION" or
      "MICROSOFT.AUTOMATION/AUTOMATIONACCOUNTS/WEBHOOKS/WRITE"
    ) and
  event.outcome:(Success or success)

```
