---
id: enSecuritySensitiveFilesCompression
slug: /en/security/sensitive-files-compression
title: Sensitive Files Compression
description: Description to be written
tags: []
---

<div id="sensitive-files-compression"></div>

Identifies the use of a compression utility to collect known files containing sensitive information, such as credentials and system configurations.

**Rule type**: query

**Rule indices**: 

* auditbeat-*
* logs-endpoint.events.*
* endgame-*

**Severity**: medium

**Risk score**: 47

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="enSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://www.trendmicro.com/en_ca/research/20/l/teamtnt-now-deploying-ddos-capable-irc-bot-tntbotinger.html

**Tags**: 

* Domain: Endpoint
* OS: Linux
* Use Case: Threat Detection
* Tactic: Collection
* Tactic: Credential Access
* Data Source: Elastic Endgame

**Version**: 104

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
event.category:process and host.os.type:linux and event.type:start and
  process.name:(zip or tar or gzip or hdiutil or 7z) and
  process.args:
    (
      /root/.ssh/id_rsa or
      /root/.ssh/id_rsa.pub or
      /root/.ssh/id_ed25519 or
      /root/.ssh/id_ed25519.pub or
      /root/.ssh/authorized_keys or
      /root/.ssh/authorized_keys2 or
      /root/.ssh/known_hosts or
      /root/.bash_history or
      /etc/hosts or
      /home/*/.ssh/id_rsa or
      /home/*/.ssh/id_rsa.pub or
      /home/*/.ssh/id_ed25519 or
      /home/*/.ssh/id_ed25519.pub or
      /home/*/.ssh/authorized_keys or
      /home/*/.ssh/authorized_keys2 or
      /home/*/.ssh/known_hosts or
      /home/*/.bash_history or
      /root/.aws/credentials or
      /root/.aws/config or
      /home/*/.aws/credentials or
      /home/*/.aws/config or
      /root/.docker/config.json or
      /home/*/.docker/config.json or
      /etc/group or
      /etc/passwd or
      /etc/shadow or
      /etc/gshadow
    )

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Credential Access
    * ID: TA0006
    * Reference URL: https://attack.mitre.org/tactics/TA0006/
* Technique:
    * Name: Unsecured Credentials
    * ID: T1552
    * Reference URL: https://attack.mitre.org/techniques/T1552/
* Sub-technique:
    * Name: Credentials In Files
    * ID: T1552.001
    * Reference URL: https://attack.mitre.org/techniques/T1552/001/
* Tactic:
    * Name: Collection
    * ID: TA0009
    * Reference URL: https://attack.mitre.org/tactics/TA0009/
* Technique:
    * Name: Archive Collected Data
    * ID: T1560
    * Reference URL: https://attack.mitre.org/techniques/T1560/
* Sub-technique:
    * Name: Archive via Utility
    * ID: T1560.001
    * Reference URL: https://attack.mitre.org/techniques/T1560/001/

