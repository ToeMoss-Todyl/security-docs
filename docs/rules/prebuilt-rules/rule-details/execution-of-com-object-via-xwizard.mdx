---
id: enSecurityExecutionOfComObjectViaXwizard
slug: /en/security/execution-of-com-object-via-xwizard
title: Execution of COM object via Xwizard
description: Description to be written
tags: []
---

<div id="execution-of-com-object-via-xwizard"></div>

Windows Component Object Model (COM) is an inter-process communication (IPC) component of the native Windows application programming interface (API) that enables interaction between software objects or executable code. Xwizard can be used to run a COM object created in registry to evade defensive counter measures.

**Rule type**: eql

**Rule indices**: 

* winlogbeat-*
* logs-endpoint.events.*
* logs-windows.*
* endgame-*

**Severity**: medium

**Risk score**: 47

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="enSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://lolbas-project.github.io/lolbas/Binaries/Xwizard/
* http://www.hexacorn.com/blog/2017/07/31/the-wizard-of-x-oppa-plugx-style/

**Tags**: 

* Domain: Endpoint
* OS: Windows
* Use Case: Threat Detection
* Tactic: Execution
* Data Source: Elastic Endgame

**Version**: 105

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Investigation guide

```markdown

```

## Rule query

```js
process where host.os.type == "windows" and event.type == "start" and
 process.pe.original_file_name : "xwizard.exe" and
 (
   (process.args : "RunWizard" and process.args : "{*}") or
   (process.executable != null and
     not process.executable : ("C:\\Windows\\SysWOW64\\xwizard.exe", "C:\\Windows\\System32\\xwizard.exe")
   )
 )

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Execution
    * ID: TA0002
    * Reference URL: https://attack.mitre.org/tactics/TA0002/
* Technique:
    * Name: Inter-Process Communication
    * ID: T1559
    * Reference URL: https://attack.mitre.org/techniques/T1559/
* Sub-technique:
    * Name: Component Object Model
    * ID: T1559.001
    * Reference URL: https://attack.mitre.org/techniques/T1559/001/

