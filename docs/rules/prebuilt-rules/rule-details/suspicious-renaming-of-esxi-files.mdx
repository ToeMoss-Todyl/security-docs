---
id: serverlessSecuritySuspiciousRenamingOfEsxiFiles
slug: /en/security/suspicious-renaming-of-esxi-files
title: Suspicious Renaming of ESXI Files
description: Description to be written
tags: []
---

<div id="suspicious-renaming-of-esxi-files"></div>

Identifies instances where VMware-related files, such as those with extensions like ".vmdk", ".vmx", ".vmxf", ".vmsd", ".vmsn", ".vswp", ".vmss", ".nvram", and ".vmem", are renamed on a Linux system. The rule monitors for the "rename" event action associated with these file types, which could indicate malicious activity.

**Rule type**: eql

**Rule indices**: 

* logs-endpoint.events.*

**Severity**: medium

**Risk score**: 47

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="serverlessSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://www.bleepingcomputer.com/news/security/massive-esxiargs-ransomware-attack-targets-vmware-esxi-servers-worldwide/

**Tags**: 

* Domain: Endpoint
* OS: Linux
* Use Case: Threat Detection
* Tactic: Defense Evasion

**Version**: 2

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
file where host.os.type == "linux" and event.action == "rename" and
file.Ext.original.name : ("*.vmdk", "*.vmx", "*.vmxf", "*.vmsd", "*.vmsn", "*.vswp", "*.vmss", "*.nvram", "*.vmem")
and not file.name : ("*.vmdk", "*.vmx", "*.vmxf", "*.vmsd", "*.vmsn", "*.vswp", "*.vmss", "*.nvram", "*.vmem")

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Defense Evasion
    * ID: TA0005
    * Reference URL: https://attack.mitre.org/tactics/TA0005/
* Technique:
    * Name: Masquerading
    * ID: T1036
    * Reference URL: https://attack.mitre.org/techniques/T1036/
* Sub-technique:
    * Name: Rename System Utilities
    * ID: T1036.003
    * Reference URL: https://attack.mitre.org/techniques/T1036/003/

