---
id: enSecurityPersistenceViaDirectoryservicePluginModification
slug: /en/security/persistence-via-directoryservice-plugin-modification
title: Persistence via DirectoryService Plugin Modification
description: Description to be written
tags: []
---

<div id="persistence-via-directoryservice-plugin-modification"></div>

Identifies the creation or modification of a DirectoryService PlugIns (dsplug) file. The DirectoryService daemon launches on each system boot and automatically reloads after crash. It scans and executes bundles that are located in the DirectoryServices PlugIns folder and can be abused by adversaries to maintain persistence.

**Rule type**: query

**Rule indices**: 

* auditbeat-*
* logs-endpoint.events.*

**Severity**: medium

**Risk score**: 47

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="enSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://blog.chichou.me/2019/11/21/two-macos-persistence-tricks-abusing-plugins/

**Tags**: 

* Domain: Endpoint
* OS: macOS
* Use Case: Threat Detection
* Tactic: Persistence

**Version**: 103

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
event.category:file and host.os.type:macos and not event.type:deletion and
  file.path:/Library/DirectoryServices/PlugIns/*.dsplug

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Persistence
    * ID: TA0003
    * Reference URL: https://attack.mitre.org/tactics/TA0003/
* Technique:
    * Name: Boot or Logon Autostart Execution
    * ID: T1547
    * Reference URL: https://attack.mitre.org/techniques/T1547/

