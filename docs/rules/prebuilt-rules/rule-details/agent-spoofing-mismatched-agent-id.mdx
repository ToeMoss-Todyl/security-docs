---
id: serverlessSecurityAgentSpoofingMismatchedAgentId
slug: /serverless/security/agent-spoofing-mismatched-agent-id
title: Agent Spoofing - Mismatched Agent ID
description: Description to be written
tags: []
---

<div id="agent-spoofing-mismatched-agent-id"></div>

Detects events that have a mismatch on the expected event agent ID. The status "agent_id_mismatch" occurs when the expected agent ID associated with the API key does not match the actual agent ID in an event. This could indicate attempts to spoof events in order to masquerade actual activity to evade detection.

**Rule type**: query

**Rule indices**: 

* logs-*
* metrics-*
* traces-*

**Severity**: high

**Risk score**: 73

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="serverlessSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: None

**Tags**: 

* Use Case: Threat Detection
* Tactic: Defense Evasion

**Version**: 101

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
event.agent_id_status:agent_id_mismatch

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Defense Evasion
    * ID: TA0005
    * Reference URL: https://attack.mitre.org/tactics/TA0005/
* Technique:
    * Name: Masquerading
    * ID: T1036
    * Reference URL: https://attack.mitre.org/techniques/T1036/

