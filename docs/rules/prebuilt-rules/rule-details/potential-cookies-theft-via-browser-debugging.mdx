---
id: serverlessSecurityPotentialCookiesTheftViaBrowserDebugging
slug: /en/security/potential-cookies-theft-via-browser-debugging
title: Potential Cookies Theft via Browser Debugging
description: Description to be written
tags: []
---

<div id="potential-cookies-theft-via-browser-debugging"></div>

Identifies the execution of a Chromium based browser with the debugging process argument, which may indicate an attempt to steal authentication cookies. An adversary may steal web application or service session cookies and use them to gain access web applications or Internet services as an authenticated user without needing credentials.

**Rule type**: eql

**Rule indices**: 

* auditbeat-*
* winlogbeat-*
* logs-endpoint.events.*
* logs-windows.*

**Severity**: medium

**Risk score**: 47

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="serverlessSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 33

**References**: 

* https://github.com/defaultnamehere/cookie_crimes
* https://embracethered.com/blog/posts/2020/cookie-crimes-on-mirosoft-edge/
* https://github.com/rapid7/metasploit-framework/blob/master/documentation/modules/post/multi/gather/chrome_cookies.md
* https://posts.specterops.io/hands-in-the-cookie-jar-dumping-cookies-with-chromiums-remote-debugger-port-34c4f468844e

**Tags**: 

* Domain: Endpoint
* OS: Linux
* OS: Windows
* OS: macOS
* Use Case: Threat Detection
* Tactic: Credential Access

**Version**: 102

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Investigation guide

```markdown

```

## Rule query

```js
process where event.type in ("start", "process_started", "info") and
  process.name in (
             "Microsoft Edge",
             "chrome.exe",
             "Google Chrome",
             "google-chrome-stable",
             "google-chrome-beta",
             "google-chrome",
             "msedge.exe") and
   process.args : ("--remote-debugging-port=*",
                   "--remote-debugging-targets=*",
                   "--remote-debugging-pipe=*") and
   process.args : "--user-data-dir=*" and not process.args:"--remote-debugging-port=0"

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Credential Access
    * ID: TA0006
    * Reference URL: https://attack.mitre.org/tactics/TA0006/
* Technique:
    * Name: Steal Web Session Cookie
    * ID: T1539
    * Reference URL: https://attack.mitre.org/techniques/T1539/

