---
id: serverlessSecurityAzureServicePrincipalCredentialsAdded
slug: /en/security/azure-service-principal-credentials-added
title: Azure Service Principal Credentials Added
description: Description to be written
tags: []
---

<div id="azure-service-principal-credentials-added"></div>

Identifies when new Service Principal credentials have been added in Azure. In most organizations, credentials will be added to service principals infrequently. Hijacking an application (by adding a rogue secret or certificate) with granted permissions will allow the attacker to access data that is normally protected by MFA requirements.

**Rule type**: query

**Rule indices**: 

* filebeat-*
* logs-azure*

**Severity**: medium

**Risk score**: 47

**Runs every**: 10m

**Searches indices from**: now-25m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="serverlessSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://www.fireeye.com/content/dam/collateral/en/wp-m-unc2452.pdf

**Tags**: 

* Domain: Cloud
* Data Source: Azure
* Use Case: Identity and Access Audit
* Tactic: Impact

**Version**: 102

**Rule authors**: 

* Elastic
* Austin Songer

**Rule license**: Elastic License v2

## Investigation guide

```markdown

```

## Rule query

```js
event.dataset:azure.auditlogs and azure.auditlogs.operation_name:"Add service principal credentials" and event.outcome:(success or Success)

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Impact
    * ID: TA0040
    * Reference URL: https://attack.mitre.org/tactics/TA0040/
* Technique:
    * Name: Resource Hijacking
    * ID: T1496
    * Reference URL: https://attack.mitre.org/techniques/T1496/

