---
id: serverlessSecurityNamespaceManipulationUsingUnshare
slug: /serverless/security/namespace-manipulation-using-unshare
title: Namespace Manipulation Using Unshare
description: Description to be written
tags: []
---

<div id="namespace-manipulation-using-unshare"></div>

Identifies suspicious usage of unshare to manipulate system namespaces. Unshare can be utilized to escalate privileges or escape container security boundaries. Threat actors have utilized this binary to allow themselves to escape to the host and access other resources or escalate privileges.

**Rule type**: eql

**Rule indices**: 

* auditbeat-*
* logs-endpoint.events.*
* endgame-*

**Severity**: medium

**Risk score**: 47

**Runs every**: 5m

**Searches indices from**: now-9m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="serverlessSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://man7.org/linux/man-pages/man1/unshare.1.html
* https://www.crowdstrike.com/blog/cve-2022-0185-kubernetes-container-escape-using-linux-kernel-exploit/

**Tags**: 

* Domain: Endpoint
* OS: Linux
* Use Case: Threat Detection
* Tactic: Privilege Escalation
* Data Source: Elastic Endgame

**Version**: 5

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
process where host.os.type == "linux" and event.type == "start" and event.action : ("exec", "exec_event") and
process.executable: "/usr/bin/unshare" and
not process.parent.executable: ("/usr/bin/udevadm", "*/lib/systemd/systemd-udevd", "/usr/bin/unshare") and
not process.args : "/usr/bin/snap"

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Privilege Escalation
    * ID: TA0004
    * Reference URL: https://attack.mitre.org/tactics/TA0004/
* Technique:
    * Name: Create or Modify System Process
    * ID: T1543
    * Reference URL: https://attack.mitre.org/techniques/T1543/

