---
id: enSecuritySensitiveKeysOrPasswordsSearchedForInsideAContainer
slug: /en/security/sensitive-keys-or-passwords-searched-for-inside-a-container
title: Sensitive Keys Or Passwords Searched For Inside A Container
description: Description to be written
tags: []
---

<div id="sensitive-keys-or-passwords-searched-for-inside-a-container"></div>

This rule detects the use of system search utilities like grep and find to search for private SSH keys or passwords inside a container. Unauthorized access to these sensitive files could lead to further compromise of the container environment or facilitate a container breakout to the underlying host machine.

**Rule type**: eql

**Rule indices**: 

* logs-cloud_defend*

**Severity**: medium

**Risk score**: 47

**Runs every**: 5m

**Searches indices from**: now-6m ([Date Math format](((ref))/common-options.html#date-math), see also <DocLink id="enSecurityRulesUiCreate" section="set-the-rules-schedule">`Additional look-back time`</DocLink>)

**Maximum alerts per execution**: 100

**References**: 

* https://sysdig.com/blog/cve-2021-25741-kubelet-falco/

**Tags**: 

* Data Source: Elastic Defend for Containers
* Domain: Container
* OS: Linux
* Use Case: Threat Detection
* Tactic: Credential Access

**Version**: 2

**Rule authors**: 

* Elastic

**Rule license**: Elastic License v2

## Rule query

```js
process where container.id: "*" and event.type== "start" and
((
/*account for tools that execute utilities as a subprocess, in this case the target utility name will appear as a process arg*/  
  (process.name in ("grep", "egrep", "fgrep") or process.args in ("grep", "egrep", "fgrep")) 
    and process.args : ("*BEGIN PRIVATE*", "*BEGIN OPENSSH PRIVATE*", "*BEGIN RSA PRIVATE*", 
"*BEGIN DSA PRIVATE*", "*BEGIN EC PRIVATE*", "*pass*", "*ssh*", "*user*")
) 
or 
(
/*account for tools that execute utilities as a subprocess, in this case the target utility name will appear as a process arg*/
  (process.name in ("find", "locate", "mlocate") or process.args in ("find", "locate", "mlocate")) 
    and process.args : ("*id_rsa*", "*id_dsa*")
))

```

**Framework**: MITRE ATT&CK<sup>TM</sup>

* Tactic:
    * Name: Credential Access
    * ID: TA0006
    * Reference URL: https://attack.mitre.org/tactics/TA0006/
* Technique:
    * Name: Unsecured Credentials
    * ID: T1552
    * Reference URL: https://attack.mitre.org/techniques/T1552/
* Sub-technique:
    * Name: Credentials In Files
    * ID: T1552.001
    * Reference URL: https://attack.mitre.org/techniques/T1552/001/

